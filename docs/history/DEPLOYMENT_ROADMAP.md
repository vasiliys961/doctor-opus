# 🗺️ Схема подготовки к деплою и публикации

**Цель:** Подготовить приложение к публичному доступу с системой ограниченного доступа

---

## 📋 Общая схема шагов

```
┌─────────────────────────────────────────────────────────────┐
│ ЭТАП 1: ОЧИСТКА И ПОДГОТОВКА                                │
├─────────────────────────────────────────────────────────────┤
│ 1.1. Очистка кода (удаление мусора, неиспользуемого кода)   │
│ 1.2. Проверка безопасности (API ключи, секреты)             │
│ 1.3. Финальное тестирование функциональности                │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│ ЭТАП 2: НАСТРОЙКА GIT И РЕПОЗИТОРИЯ                         │
├─────────────────────────────────────────────────────────────┤
│ 2.1. Определить что идет в GitHub (код, документация)      │
│ 2.2. Определить что остается локально (секреты, данные)     │
│ 2.3. Настроить .gitignore (если нужно)                      │
│ 2.4. Создать/обновить README.md для публичного репозитория   │
│ 2.5. Коммит и push в GitHub                                  │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│ ЭТАП 3: ВНЕДРЕНИЕ СИСТЕМЫ ОГРАНИЧЕННОГО ДОСТУПА            │
├─────────────────────────────────────────────────────────────┤
│ 3.1. Создать файлы системы подписки                         │
│ 3.2. Настроить стартовый баланс (бесплатные единицы)         │
│ 3.3. Интегрировать проверку баланса в операции               │
│ 3.4. Добавить UI (виджет баланса, страница подписки)         │
│ 3.5. Протестировать систему ограничения                    │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│ ЭТАП 4: ДЕПЛОЙ НА REPLIT                                    │
├─────────────────────────────────────────────────────────────┤
│ 4.1. Подключить GitHub репозиторий к Replit                 │
│ 4.2. Настроить переменные окружения (API ключи)              │
│ 4.3. Установить зависимости                                 │
│ 4.4. Запустить и протестировать на Replit                   │
│ 4.5. Настроить автодеплой (если нужно)                      │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│ ЭТАП 5: ПУБЛИКАЦИЯ И МОНИТОРИНГ                             │
├─────────────────────────────────────────────────────────────┤
│ 5.1. Получить публичную ссылку Replit                        │
│ 5.2. Протестировать публичный доступ                        │
│ 5.3. Настроить мониторинг использования (баланс, логи)      │
│ 5.4. Подготовить инструкцию для пользователей                │
└─────────────────────────────────────────────────────────────┘
```

---

## 📝 Детализация шагов (кратко)

### ЭТАП 1: ОЧИСТКА И ПОДГОТОВКА
- [ ] Удалить временные файлы, мусор
- [ ] Проверить что все API ключи в secrets/env (не в коде)
- [ ] Убедиться что приложение работает стабильно

### ЭТАП 2: НАСТРОЙКА GIT
- [ ] Проверить `.gitignore` (секреты не попадут в git)
- [ ] Обновить `README.md` (описание, инструкции)
- [ ] Коммит и push в GitHub

### ЭТАП 3: СИСТЕМА ОГРАНИЧЕННОГО ДОСТУПА
- [ ] Создать `utils/subscription_manager.py`
- [ ] Создать `components/balance_display.py`
- [ ] Создать `page_modules/subscription_page.py`
- [ ] Интегрировать в `app.py` и страницы
- [ ] Настроить стартовый баланс (например, 10-20 ед. бесплатно)

### ЭТАП 4: ДЕПЛОЙ НА REPLIT
- [ ] Импортировать репозиторий из GitHub
- [ ] Настроить `.replit` и `replit.nix` (если нужно)
- [ ] Добавить API ключи в Secrets Replit
- [ ] Запустить и протестировать

### ЭТАП 5: ПУБЛИКАЦИЯ
- [ ] Получить публичную ссылку
- [ ] Протестировать с ограниченным доступом
- [ ] Мониторинг использования

---

## ⚠️ Важные моменты

1. **API ключи:** Всегда в Secrets Replit, никогда в коде
2. **Стартовый баланс:** Давать бесплатные единицы для тестирования
3. **Тестирование:** Проверять каждый этап перед переходом к следующему
4. **Откат:** Иметь возможность откатить изменения

---

## 🔄 Порядок согласования

Каждый этап будет детализироваться и согласовываться отдельно:
- ЭТАП 1 → согласование → выполнение
- ЭТАП 2 → согласование → выполнение
- И так далее...

---

**Готово к началу!** 🚀
