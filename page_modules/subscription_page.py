"""
–°—Ç—Ä–∞–Ω–∏—Ü–∞ ¬´–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π¬ª (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è).

–°–µ–π—á–∞—Å:
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∂–∏–º, –±–∞–ª–∞–Ω—Å –∏ —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏.
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –í–ê–ú (—á–µ—Ä–µ–∑ dev_mode) –≤—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤–∏—Ç—å –∫—Ä–µ–¥–∏—Ç—ã —Å–µ–±–µ/—Ç–µ—Å—Ç–æ–≤—ã–º –≤—Ä–∞—á–∞–º.

‚ö† –†–µ–∞–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π –Ω–µ—Ç, —ç—Ç–æ —Ç–æ–ª—å–∫–æ —É–ø—Ä–∞–≤–ª—è–µ–º–∞—è –º–æ–¥–µ–ª—å –±–∞–ª–∞–Ω—Å–∞.
"""

import streamlit as st

from utils.subscription_manager import (
    get_state,
    add_credits,
    is_subscription_active,
)


def show_subscription_page() -> None:
    st.title("üí≥ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π (—Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º)")

    state = get_state()

    st.markdown("### –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å")
    cols = st.columns(3)
    cols[0].metric("–†–µ–∂–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è", state.mode)
    cols[1].metric("–ë–∞–ª–∞–Ω—Å", f"{state.balance:.1f} –µ–¥.")
    cols[2].metric("–í—Å–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ", f"{state.total_used:.1f} –µ–¥.")

    if not is_subscription_active():
        st.info(
            "–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–ø–∏—Å–∫–∏ —Å–µ–π—á–∞—Å **–≤—ã–∫–ª—é—á–µ–Ω–∞** (`SUBSCRIPTION_ENABLED = False`).\n\n"
            "–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π. –í—ã –º–æ–∂–µ—Ç–µ –≤–∫–ª—é—á–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É —á–µ—Ä–µ–∑ `config.py` –∏ –∫–æ–º–º–∏—Ç."
        )

    if state.is_owner:
        st.success("–í—ã –≤ —Ä–µ–∂–∏–º–µ **–≤–ª–∞–¥–µ–ª—å—Ü–∞** (–∏–ª–∏ `.dev_mode`): "
                   "–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –±–∞–ª–∞–Ω—Å—É –Ω–µ –¥–µ–π—Å—Ç–≤—É—é—Ç.")

    st.markdown("---")
    st.markdown("### –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–º (–∞–¥–º–∏–Ω‚Äë—Ä–µ–∂–∏–º)")

    st.write(
        "–ó–¥–µ—Å—å –º–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –µ–¥–∏–Ω–∏—Ü—ã –±–∞–ª–∞–Ω—Å–∞.\n\n"
        "–í —Ä–µ–∞–ª—å–Ω–æ–π –æ–ø–ª–∞—Ç–µ —Å—é–¥–∞ –±—É–¥–µ—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å —Ñ–∞–∫—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞."
    )

    add_amount = st.number_input(
        "–°–∫–æ–ª—å–∫–æ –µ–¥–∏–Ω–∏—Ü –¥–æ–±–∞–≤–∏—Ç—å –∫ –±–∞–ª–∞–Ω—Å—É —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏:",
        min_value=0.0,
        max_value=100000.0,
        value=0.0,
        step=10.0,
    )

    if st.button("‚ûï –î–æ–±–∞–≤–∏—Ç—å –µ–¥–∏–Ω–∏—Ü—ã"):
        if add_amount > 0:
            add_credits(add_amount)
            st.success(f"–î–æ–±–∞–≤–ª–µ–Ω–æ {add_amount:.1f} –µ–¥. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –Ω–æ–≤–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞.")
        else:
            st.warning("–£–∫–∞–∂–∏—Ç–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –µ–¥–∏–Ω–∏—Ü.")

